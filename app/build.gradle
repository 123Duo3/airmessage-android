//Load keystore
def keystorePropertiesFile = rootProject.file(".signing/keystore.properties")
def keystoreProperties = new Properties()
keystoreProperties.load(new FileInputStream(keystorePropertiesFile))

apply plugin: "com.android.application"
apply plugin: "io.fabric"

android {
	signingConfigs {
		config {
			storeFile file(keystoreProperties["storeFile"])
			storePassword keystoreProperties["storePassword"]
			keyAlias keystoreProperties["keyAlias"]
			keyPassword keystoreProperties["keyPassword"]
		}
	}
	compileSdkVersion 27
	buildToolsVersion "27.0.3"
	defaultConfig {
		applicationId "me.tagavari.airmessage"
		minSdkVersion 23
		targetSdkVersion 27
		versionCode 29
		versionName "0.2.2"

		resConfigs "en", "fr"
	}
	buildTypes {
		debug {
			ext.enableCrashlytics = false

			/* minifyEnabled true
			shrinkResources true

			useProguard true
			proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.pro" */
		}
		release {
			/* minifyEnabled true
			shrinkResources true

			useProguard true
			proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.pro" */

			signingConfig signingConfigs.config
		}
	}
	lintOptions {
		abortOnError false
	}
	productFlavors {
	}
	packagingOptions {
		exclude "META-INF/DEPENDENCIES"
		exclude "META-INF/LICENSE"
	}
	dexOptions {
		javaMaxHeapSize "5g"
	}
	testOptions {
		unitTests.returnDefaultValues = true
	}
	compileOptions {
		sourceCompatibility JavaVersion.VERSION_1_8
		targetCompatibility JavaVersion.VERSION_1_8
	}
}

dependencies {
	//implementation fileTree(include: ["*.jar"], dir: "libs")
	testImplementation "junit:junit:4.12"

	//Support library
	def supportLibraryVersion = "27.1.1"
	implementation "com.android.support:appcompat-v7:$supportLibraryVersion"
	implementation "com.android.support:preference-v7:$supportLibraryVersion"
	implementation "com.android.support:preference-v14:$supportLibraryVersion"
	implementation "com.android.support:cardview-v7:$supportLibraryVersion"
	implementation "com.android.support:design:$supportLibraryVersion"
	implementation "com.android.support:customtabs:$supportLibraryVersion"

	//Android architecture components
	implementation "android.arch.lifecycle:extensions:1.1.1"

	//Backports
	implementation "net.sourceforge.streamsupport:android-retrostreams:1.6.1"
	implementation "org.lukhnos:nnio:0.2"
	//implementation "com.android.support:recyclerview-selection:28.0.0-alpha1"

	//Layouts
	implementation "com.android.support.constraint:constraint-layout:1.1.0"
	implementation "com.google.android:flexbox:0.3.2"

	implementation "com.pnikosis:materialish-progress:1.7"
	implementation "de.hdodenhof:circleimageview:2.2.0"
	implementation "nl.dionsegijn:konfetti:1.1.2"
	implementation "in.srain.cube:grid-view-with-header-footer:1.0.12"

	//Services
	implementation "com.google.firebase:firebase-core:15.0.2"
	implementation "com.crashlytics.sdk.android:crashlytics:2.9.2"

	//Helper
	implementation "com.takisoft.fix:preference-v7-ringtone:27.1.0.0"

	//Backend
	implementation "org.java-websocket:Java-WebSocket:1.3.7"
	implementation "org.jetbrains.kotlin:kotlin-stdlib:1.2.30"

	//Debugging
	//debugImplementation "com.squareup.leakcanary:leakcanary-android:1.5.4"
	//releaseImplementation "com.squareup.leakcanary:leakcanary-android-no-op:1.5.4"
}

repositories {
	maven {
		url "https://maven.google.com"
		// Alternative URL is "https://dl.google.com/dl/android/maven2/"
	}
}

apply plugin: "com.google.gms.google-services"