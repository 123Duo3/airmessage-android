<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
	xmlns:app="http://schemas.android.com/apk/res-auto"
	xmlns:tools="http://schemas.android.com/tools"
	android:layout_width="match_parent"
	android:layout_height="match_parent"
	android:clipChildren="false"
	tools:context=".Messaging">
	<!-- Recording indicator -->
	<FrameLayout
		android:id="@+id/recordingindicator"
		android:layout_width="80dp"
		android:layout_height="80dp"
		android:background="@drawable/circle"
		android:backgroundTint="@color/colorRecording"
		android:clipToPadding="false"
		android:elevation="8dp"
		android:visibility="invisible">
		
		<ImageView
			android:layout_width="wrap_content"
			android:layout_height="wrap_content"
			android:layout_gravity="center"
			android:contentDescription="@null"
			android:src="@drawable/microphone" />
	</FrameLayout>
	<!-- General layout -->
	<LinearLayout
		android:id="@+id/content"
		android:layout_width="match_parent"
		android:layout_height="match_parent"
		android:clipChildren="false"
		android:orientation="vertical">
		<!-- App bar -->
		<android.support.design.widget.AppBarLayout
			android:id="@+id/app_bar"
			android:layout_width="match_parent"
			android:layout_height="wrap_content">
			<!-- Toolbar -->
			<android.support.v7.widget.Toolbar
				android:id="@+id/toolbar"
				android:layout_width="match_parent"
				android:layout_height="?android:attr/actionBarSize"
				android:theme="@style/SolidActionBar" />
			<!-- Info bar container -->
			<LinearLayout
				android:id="@+id/infobar_container"
				android:layout_width="match_parent"
				android:layout_height="wrap_content"
				android:animateLayoutChanges="true"
				android:background="?android:attr/colorBackgroundFloating"
				android:orientation="vertical" />
		</android.support.design.widget.AppBarLayout>
		<!-- Search result bar -->
		<LinearLayout
			android:id="@+id/searchresults"
			android:layout_width="match_parent"
			android:layout_height="wrap_content"
			android:background="?android:attr/colorBackgroundFloating"
			android:elevation="4dp"
			android:minHeight="48dp"
			android:orientation="horizontal"
			android:visibility="gone">
			
			<TextView
				android:id="@+id/searchresults_message"
				android:layout_width="0dp"
				android:layout_height="wrap_content"
				android:layout_gravity="center_vertical"
				android:layout_marginLeft="16dp"
				android:layout_marginRight="16dp"
				android:layout_weight="1"
				android:gravity="center_vertical"
				android:paddingBottom="12dp"
				android:paddingTop="12dp"
				android:text="@string/message_searchresults"
				android:textColor="?android:attr/textColorSecondary" />
			
			<ImageButton
				android:layout_width="wrap_content"
				android:layout_height="wrap_content"
				android:layout_gravity="center_vertical"
				android:layout_marginEnd="5dp"
				android:background="?android:attr/selectableItemBackgroundBorderless"
				android:onClick="onClickSearchPrevious"
				android:padding="5dp"
				android:src="@drawable/chevron_left"
				android:tint="?android:attr/textColorSecondary" />
			
			<ImageButton
				android:layout_width="wrap_content"
				android:layout_height="wrap_content"
				android:layout_gravity="center_vertical"
				android:layout_marginEnd="5dp"
				android:background="?android:attr/selectableItemBackgroundBorderless"
				android:onClick="onClickSearchNext"
				android:padding="5dp"
				android:src="@drawable/chevron_right"
				android:tint="?android:attr/textColorSecondary" />
		</LinearLayout>
		<!-- Message view -->
		<android.support.constraint.ConstraintLayout
			android:layout_width="match_parent"
			android:layout_height="0dp"
			android:layout_weight="1"
			android:clipChildren="false">
			<!-- Message list -->
			<android.support.v7.widget.RecyclerView
				android:id="@+id/list_messages"
				android:layout_width="0px"
				android:layout_height="0px"
				android:clipChildren="false"
				android:clipToPadding="false"
				android:divider="@null"
				android:dividerHeight="0dp"
				android:listSelector="@android:color/transparent"
				android:paddingBottom="5dp"
				android:paddingTop="5dp"
				android:theme="@style/OverscrollNeutralizer"
				app:layoutManager=".Messaging$SpeedyLinearLayoutManager"
				app:layout_constraintBottom_toBottomOf="parent"
				app:layout_constraintLeft_toLeftOf="parent"
				app:layout_constraintRight_toRightOf="parent"
				app:layout_constraintTop_toTopOf="parent"
				app:stackFromEnd="true" />
			<!-- Foreground effect view -->
			<me.tagavari.airmessage.view.AppleEffectView
				android:id="@+id/effect_foreground"
				android:layout_width="match_parent"
				android:layout_height="match_parent" />
			<!-- Konfetti view -->
			<nl.dionsegijn.konfetti.KonfettiView
				android:id="@+id/konfetti"
				android:layout_width="match_parent"
				android:layout_height="match_parent" />
			<!-- Floating Action Button -->
			<android.support.design.widget.FloatingActionButton
				android:id="@+id/fab_bottom"
				android:layout_width="40dp"
				android:layout_height="40dp"
				android:layout_margin="16dp"
				android:src="@drawable/chevron_down"
				android:visibility="gone"
				app:backgroundTint="?android:attr/colorBackgroundFloating"
				app:fabSize="mini"
				app:layout_constraintBottom_toBottomOf="parent"
				app:layout_constraintEnd_toEndOf="parent"
				app:tint="@color/colorPrimary" />
			
			<TextView
				android:id="@+id/fab_bottom_badge"
				android:layout_width="wrap_content"
				android:layout_height="19dp"
				android:background="@drawable/rounded_circle"
				android:backgroundTint="@color/colorPrimaryDark"
				android:gravity="center"
				android:maxLines="1"
				android:minWidth="19dp"
				android:paddingLeft="6dp"
				android:paddingRight="6dp"
				android:scaleX="0"
				android:scaleY="0"
				android:text="0"
				android:textColor="@android:color/primary_text_dark"
				android:textSize="12sp"
				android:translationX="-6dp"
				android:translationY="6dp"
				android:translationZ="12dp"
				android:visibility="gone"
				app:layout_constraintBottom_toTopOf="@+id/fab_bottom"
				app:layout_constraintEnd_toEndOf="@+id/fab_bottom"
				app:layout_constraintStart_toEndOf="@+id/fab_bottom"
				app:layout_constraintTop_toTopOf="@+id/fab_bottom" />
			
			<View
				android:id="@+id/fab_bottom_splash"
				android:layout_width="40dp"
				android:layout_height="40dp"
				android:alpha="0.5"
				android:background="@drawable/circle"
				android:visibility="gone"
				app:layout_constraintLeft_toLeftOf="@+id/fab_bottom"
				app:layout_constraintTop_toTopOf="@+id/fab_bottom" />
		</android.support.constraint.ConstraintLayout>
		<!-- Input bar -->
		<RelativeLayout
			android:id="@+id/inputbar"
			android:layout_width="match_parent"
			android:layout_height="wrap_content"
			android:background="?android:attr/colorBackgroundFloating"
			android:clipToPadding="false"
			android:elevation="8dp"
			android:minHeight="45dp"
			android:visibility="visible">
			<!-- Reference bar -->
			<View
				android:id="@+id/referencebar"
				android:layout_width="wrap_content"
				android:layout_height="45dp"
				android:layout_gravity="bottom"
				android:visibility="invisible" />
			<!-- Message bar -->
			<LinearLayout
				android:id="@+id/messagebar"
				android:layout_width="match_parent"
				android:layout_height="wrap_content"
				android:layout_gravity="bottom"
				android:orientation="horizontal"
				android:visibility="visible">
				<!-- Add button -->
				<ImageButton
					android:id="@+id/button_addcontent"
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_gravity="bottom"
					android:background="?android:attr/selectableItemBackgroundBorderless"
					android:clickable="true"
					android:contentDescription="@string/action_addcontent"
					android:focusable="true"
					android:padding="10dp"
					android:src="@drawable/add"
					android:tag="@string/tag_primarytint"
					android:tint="@color/colorPrimary"
					android:tooltipText="@string/action_addcontent" />
				<!-- Message box -->
				<EditText
					android:id="@+id/messagebox"
					android:layout_width="0dp"
					android:layout_height="wrap_content"
					android:layout_weight="1"
					android:background="@null"
					android:hint="@string/imperative_messageinput"
					android:imeOptions="flagNoExtractUi"
					android:inputType="text|textMultiLine|textAutoCorrect|textCapSentences"
					android:maxHeight="100dp"
					android:maxLength="1000"
					android:minHeight="45dp"
					android:paddingBottom="5dp"
					android:paddingTop="5dp"
					android:textCursorDrawable="@null" />
				<!-- Send button -->
				<ImageButton
					android:id="@+id/button_send"
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_gravity="bottom"
					android:background="?android:attr/selectableItemBackgroundBorderless"
					android:contentDescription="@string/action_send"
					android:padding="10dp"
					android:src="@drawable/push"
					android:tag="@string/tag_primarytint"
					android:tint="@color/colorPrimary"
					android:tooltipText="@string/action_send" />
			</LinearLayout>
			<!-- Content bar -->
			<RelativeLayout
				android:id="@+id/contentbar"
				android:layout_width="match_parent"
				android:layout_height="45dp"
				android:layout_gravity="bottom"
				android:background="@color/colorPrimary"
				android:tag="@string/tag_primarytint"
				android:visibility="gone">
				<!-- Close button -->
				<ImageButton
					android:id="@+id/button_closecontent"
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_centerVertical="true"
					android:layout_gravity="bottom"
					android:background="?android:attr/selectableItemBackgroundBorderless"
					android:contentDescription="@string/action_close"
					android:padding="10dp"
					android:src="@drawable/add"
					android:tint="@android:color/white"
					android:tooltipText="@string/action_close" />
				<!-- Content buttons -->
				<LinearLayout
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_alignParentEnd="true"
					android:layout_centerVertical="true"
					android:orientation="horizontal">
					<!-- Camera button -->
					<ImageButton
						android:id="@+id/button_camera"
						android:layout_width="wrap_content"
						android:layout_height="wrap_content"
						android:layout_gravity="bottom"
						android:layout_marginEnd="5dp"
						android:background="?android:attr/selectableItemBackgroundBorderless"
						android:contentDescription="@string/action_takephoto"
						android:padding="10dp"
						android:src="@drawable/camera"
						android:tint="@android:color/white"
						android:tooltipText="@string/action_takephoto" />
					<!-- Gallery button -->
					<ImageButton
						android:id="@+id/button_gallery"
						android:layout_width="wrap_content"
						android:layout_height="wrap_content"
						android:layout_gravity="bottom"
						android:layout_marginEnd="5dp"
						android:background="?android:attr/selectableItemBackgroundBorderless"
						android:contentDescription="@string/action_choosephoto"
						android:padding="10dp"
						android:src="@drawable/gallery"
						android:tint="@android:color/white"
						android:tooltipText="@string/action_choosephoto" />
					<!-- Attach button -->
					<ImageButton
						android:id="@+id/button_attach"
						android:layout_width="wrap_content"
						android:layout_height="wrap_content"
						android:layout_gravity="bottom"
						android:layout_marginEnd="5dp"
						android:background="?android:attr/selectableItemBackgroundBorderless"
						android:contentDescription="@string/action_choosefile"
						android:padding="10dp"
						android:src="@drawable/attach"
						android:tint="@android:color/white"
						android:tooltipText="@string/action_choosefile" />
					<!-- Microphone button -->
					<ImageButton
						android:id="@+id/button_record"
						android:layout_width="wrap_content"
						android:layout_height="wrap_content"
						android:layout_gravity="bottom"
						android:background="?android:attr/selectableItemBackgroundBorderless"
						android:contentDescription="@string/action_recordaudio"
						android:padding="10dp"
						android:src="@drawable/microphone"
						android:tint="@android:color/white"
						android:tooltipText="@string/action_recordaudio" />
				</LinearLayout>
			</RelativeLayout>
			<!-- Recording bar -->
			<LinearLayout
				android:id="@+id/recordingbar"
				android:layout_width="match_parent"
				android:layout_height="45dp"
				android:layout_gravity="bottom"
				android:background="?android:attr/colorBackgroundFloating"
				android:gravity="center_vertical"
				android:orientation="horizontal"
				android:paddingLeft="15dp"
				android:paddingRight="15dp"
				android:visibility="gone">
				<!-- Recording dot -->
				<View
					android:id="@+id/recordingtime_dot"
					android:layout_width="10dp"
					android:layout_height="10dp"
					android:background="@drawable/circle"
					android:backgroundTint="@color/colorRecording" />
				<!-- Recording time -->
				<TextView
					android:id="@+id/recordingtime"
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_gravity="center_vertical"
					android:layout_marginStart="8dp"
					android:text="@string/placeholder_recordingtime"
					android:textColor="?android:attr/textColorPrimary"
					android:textSize="15sp" />
				<!-- Cancel text -->
				<TextView
					android:layout_width="wrap_content"
					android:layout_height="wrap_content"
					android:layout_gravity="center_vertical"
					android:layout_marginStart="60dp"
					android:drawableStart="@drawable/chevron_left"
					android:drawableTint="?android:attr/textColorSecondary"
					android:gravity="center"
					android:text="@string/imperative_recording_cancel"
					android:textColor="?android:attr/textColorSecondary"
					app:layout_constraintBottom_toBottomOf="parent"
					app:layout_constraintLeft_toLeftOf="parent"
					app:layout_constraintRight_toRightOf="parent"
					app:layout_constraintTop_toTopOf="parent" />
			</LinearLayout>
		</RelativeLayout>
	</LinearLayout>
	<!-- Loading label -->
	<TextView
		android:id="@+id/loading_text"
		android:layout_width="wrap_content"
		android:layout_height="wrap_content"
		android:layout_centerInParent="true"
		android:text="@string/progress_loadingmessages"
		android:textAlignment="center"
		android:textColor="?android:textColorSecondary"
		android:visibility="gone" />
	<!-- Error view -->
	<LinearLayout
		android:id="@+id/group_error"
		android:layout_width="wrap_content"
		android:layout_height="wrap_content"
		android:layout_centerInParent="true"
		android:gravity="center"
		android:orientation="vertical"
		android:visibility="gone">
		
		<TextView
			android:id="@+id/group_error_label"
			android:layout_width="wrap_content"
			android:layout_height="wrap_content"
			android:text="@string/message_loaderror_conversation"
			android:textAlignment="center"
			android:textColor="?android:textColorSecondary" />
		
		<Button
			style="@style/Widget.AppCompat.Button.Borderless.Colored"
			android:layout_width="wrap_content"
			android:layout_height="wrap_content"
			android:onClick="onClickRetryLoad"
			android:tag="@string/tag_primarytint"
			android:text="@string/action_retry" />
	</LinearLayout>
</RelativeLayout>